function A = characteristic_matrix_ellipsoid(q0, q1, q2, q3, r1, r2, r3)

	a11 = 4.0 * r2^2 * (q0 * q3 + q1 * q2)^2 + 4.0 * r3^2 * (q0 * q2 - q1 * q3)^2 + r1^2 * (q0^2 + q1^2 - q2^2 - q3^2)^2;
	a12 = r2^2 * (2.0 * q0 * q3 + 2.0 * q1 * q2) * (q0^2 - q1^2 + q2^2 - q3^2) - r1^2 * (2.0 * q0 * q3 - 2.0 * q1 * q2) * (q0^2 + q1^2 - q2^2 - q3^2) - r3^2 * (2.0 * q0 * q1 + 2.0 * q2 * q3) * (2.0 * q0 * q2 - 2.0 * q1 * q3);
	a13 = r1^2 * (2.0 * q0 * q2 + 2.0 * q1 * q3) * (q0^2 + q1^2 - q2^2 - q3^2) - r3^2 * (2.0 * q0 * q2 - 2.0 * q1 * q3) * (q0^2 - q1^2 - q2^2 + q3^2) - r2^2 * (2.0 * q0 * q1 - 2.0 * q2 * q3) * (2.0 * q0 * q3 + 2.0 * q1 * q2);
	a21 = a12;
	a22 = 4.0 * r1^2 * (q0 * q3 - q1 * q2)^2 + 4.0 * r3^2 * (q0 * q1 + q2 * q3)^2 + r2^2 * (q0^2 - q1^2 + q2^2 - q3^2)^2;
	a23 = r3^2 * (2.0 * q0 * q1 + 2.0 * q2 * q3) * (q0^2 - q1^2 - q2^2 + q3^2) - r2^2 * (2.0 * q0 * q1 - 2.0 * q2 * q3) * (q0^2 - q1^2 + q2^2 - q3^2) - r1^2 * (2.0 * q0 * q2 + 2.0 * q1 * q3) * (2.0 * q0 * q3 - 2.0 * q1 * q2);
	a31 = a13;
	a32 = a23;
	a33 = 4.0 * r1^2 * (q0 * q2 + q1 * q3)^2 + 4.0 * r2^2 * (q0 * q1 - q2 * q3)^2 + r3^2 * (q0^2 - q1^2 - q2^2 + q3^2)^2;

    A = [a11 a12 a13 ; a21 a22 a23 ; a31 a32 a33];
end